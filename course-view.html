<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Course â€“ EduOS</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore-compat.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
  <!-- Header/nav same -->

  <main>
    <h1 id="courseTitle"></h1>
    <div id="content"></div>
    <button onclick="generateCertificate()">Download Certificate</button>
  </main>

  <script src="script.js"></script>
  <script>
    const urlParams = new URLSearchParams(window.location.search);
    const courseId = urlParams.get('id');

    auth.onAuthStateChanged(async user => {
      if (!user) return window.location.href = 'index.html';

      const userDoc = await db.collection('users').doc(user.uid).get();
      const hasAccess = userDoc.data()?.plan === 'premium' || userDoc.data()?.purchasedCourses?.includes(courseId);

      const courseDoc = await db.collection('courses').doc(courseId).get();
      document.getElementById('courseTitle').textContent = courseDoc.data().title;

      // Load modules/videos (expand as needed)
      document.getElementById('content').innerHTML = '<p>Course content loading... (add modules/videos in Firestore)</p>';
    });

    function generateCertificate() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      doc.setFontSize(22);
      doc.text('EduOS Certificate of Completion', 105, 80, { align: 'center' });
      doc.setFontSize(16);
      doc.text(document.getElementById('courseTitle').textContent, 105, 100, { align: 'center' });
      doc.text('Awarded to: ' + (auth.currentUser?.email || 'Student'), 105, 120, { align: 'center' });
      doc.save('EduOS-Certificate.pdf');
    }
  </script>
</body>
</html>
